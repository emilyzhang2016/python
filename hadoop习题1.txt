
使⽤用Hive或者⾃自定义MR实现如下逻辑
product_no lac_id moment start_time user_id county_id staytime city_id
13429100031 22554 8 2013-03-1108:55:19.151754088 571 571 282 571
13429100082 22540 8 2013-03-1108:58:20.152622488 571 571 270 571 
13429100082 22691 8 2013-03-1108:56:37.149593624 571 571 103 571
13429100087 22705 8 2013-03-1108:56:51.139539816 571 571 220 571 
13429100087 22540 8 2013-03-1108:55:45.150276800 571 571 66 571
13429100082 22540 8 2013-03-1108:55:38.140225200 571 571 133 571
13429100140 26642 9 2013-03-1109:02:19.151754088 571 571 18 571 
13429100082 22691 8 2013-03-1108:57:32.151754088 571 571 287 571
13429100189 22558 8 2013-03-1108:56:24.139539816 571 571 48 571
13429100349 22503 8 2013-03-1108:54:30.152622440 571 571 211 571
字段解释:
product_no:⽤用户⼿手机号;
lac_id:⽤用户所在基站;
start_time:⽤用户在此基站的开始时间;
staytime:⽤用户在此基站的逗留时间。
需求描述: 根据lac_id和start_time知道⽤用户当时的位置,根据staytime知道⽤用户各个基站的逗留时⻓长。根据轨迹合并连续基站的 staytime。
最终得到每⼀一个⽤用户按时间排序在每⼀一个基站驻留时⻓长
期望输出举例:
13429100082 22540 8 2013-03-1108:58:20.152622488 571 571 270 571
13429100082 22691 8 2013-03-1108:56:37.149593624 571 571 390 571
13429100082 22540 8 2013-03-1108:55:38.140225200 571 571 133 571
13429100087 22705 8 2013-03-1108:56:51.139539816 571 571 220 571
13429100087 22540 8 2013-03-1108:55:45.150276800 571 571 66 571 
